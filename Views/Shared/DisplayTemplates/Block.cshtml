@model BlockChain_FP_ITStep.Models.Block

@{
    var props = Model.GetType().GetProperties();
}

<div class="card shadow-sm mb-3">
    <div class="card-header bg-primary text-white">
        Block #@Model.Index
    </div>

    <div class="card-body">
        <table class="table table-sm align-middle mb-0">
            @foreach (var prop in props)
            {
                var name = prop.Name;
                var rawValue = prop.GetValue(Model);
                var value = rawValue?.ToString() ?? "—";    // тире если null
                bool isCopyable = name is "Hash" or "PrevHash" or "Signature" or "PublicKeyXml";

                <tr>
                    <th style="width: 20%;">@name</th>
                    <td style="word-break: break-all; vertical-align: middle;">
                        @if (name == "PublicKeyXml")
                        {
                            <div class="d-flex justify-content-between align-items-start flex-wrap">
                                <pre class="font-monospace small mb-0 me-2 flex-grow-1"
                                     style="white-space: pre-wrap; word-break: break-all;">@value</pre>
                                <button type="button"
                                        class="btn btn-link btn-sm p-0"
                                        title="Copy"
                                        onclick="copyToClipboard('@value')">
                                    Copy
                                </button>
                            </div>
                        }
                        else if (isCopyable)
                        {
                            <div class="d-flex justify-content-between align-items-center flex-wrap">
                                <span class="font-monospace flex-grow-1 text-break">@value</span>
                                <button type="button"
                                        class="btn btn-link btn-sm p-0"
                                        title="Copy"
                                        onclick="copyToClipboard('@value')">
                                    Copy
                                </button>
                            </div>
                        }
                        else
                        {
                            @value
                        }
                    </td>
                </tr>
            }
        </table>
    </div>
</div>
